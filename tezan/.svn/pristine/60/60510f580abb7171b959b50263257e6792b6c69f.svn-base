<?php/** * securitycheck:1表示不进行权限校验 */$Delete = true;$addlink = true;$ExportExcel = false;$MassSendApprove=false;if (!function_exists('check_add')) {    function check_add() {        global $current_user,$supplierid,$supplierusertype;        if(isset($supplierid) && $supplierid != ""){            return '<a data-id="edit" class="btn btn-default" data-icon="edit" data-toggle="navtab" data-title="新建" href="index.php?module=Mall_Products&action=EditView"><span>新建</span></a>';        }else{            return false;        }    }}if (!function_exists('ModifyMemberRate')) {    function ModifyMemberRate(){        global $current_user,$supplierid,$supplierusertype;        if (isset($supplierid) && $supplierid != "" && $supplierusertype=='boss')            return '<a href="index.php?module=Mall_Products&action=ModifyMemberRate" data-title="修改会员佣金" data-id="edit" class="btn btn-default" data-group="ids" data-icon="edit" data-toggle="doajaxchecked" data-dialog=true><span>修改会员佣金</span></a>';        else            return "";    }}if (!function_exists('ModifySequence')) {    function ModifySequence(){        global $current_user,$supplierid,$supplierusertype;        if (isset($supplierid) && $supplierid != "" && $supplierusertype=='boss')            return '<a href="index.php?module=Mall_Products&action=ModifySequence" data-title="首页置顶" data-id="edit" class="btn btn-default" data-group="ids" data-icon="edit" data-toggle="doajaxchecked" data-dialog=true><span>首页置顶</span></a>';        else            return "";    }}if (!function_exists('isCanOnShelf')) {    function isCanOnShelf(){        global $current_user,$supplierid,$supplierusertype;        if (isset($supplierid) && $supplierid != "" )            return '<a data-id="edit" class="btn btn-default" data-group="ids" data-icon="edit" data-toggle="doajaxchecked" data-dialog=true href="index.php?module=Mall_Products&action=onshelf" data-title="确实要上架这些商品吗?"><span>上架</span></a>';        else            return "";    }}if (!function_exists('isCanOffShelf')) {    function isCanOffShelf(){        global $current_user,$supplierid,$supplierusertype;        if (isset($supplierid) && $supplierid != "" )            return '<a data-id="edit" class="btn btn-default" data-group="ids" data-icon="edit" data-toggle="doajaxchecked" data-dialog=true href="index.php?module=Mall_Products&action=offshelf" data-title="确实要下架这些商品吗?"><span>下架</span></a>';        else            return "";    }}if (!function_exists('ClearAllPropertys')) {    function ClearAllPropertys(){        global $current_user;        if (is_admin($current_user))            return '<a href="index.php?module=Mall_Products&action=ClearAllPropertys" data-id="edit" class="btn btn-default" data-group="ids" data-icon="edit" data-toggle="doajaxchecked" data-dialog=true><span>清除所有属性</span></a>';        else            return "";    }}if (!function_exists('WebLink')) {    function WebLink(){        global $current_user,$supplierid,$supplierusertype;        if (isset($supplierid) && $supplierid != "" && $supplierusertype=='boss')            return '<a href="index.php?module=Mall_Products&action=WebLink" data-title="获取商品推文链接" data-height="400" data-width="600" data-id="edit" class="btn btn-default" data-group="ids" data-icon="edit" data-toggle="doajaxchecked" data-dialog=true><span>推文链接</span></a>';        else            return "";    }}if (!function_exists('needdistribution')) {    function NeedDistribution(){        global $current_user,$supplierid,$supplierusertype;        if (isset($supplierid) && $supplierid != "" && $supplierusertype=='boss')            return '<a href="index.php?module=Mall_Products&action=NeedDistribution" data-title="申请分销" data-height="400" data-width="660" data-id="edit" class="btn btn-default" data-group="ids" data-icon="edit" data-toggle="doajaxchecked" data-dialog=true><span>我要分销</span></a>';        else            return "";    }}global $copyrights;if ($copyrights['name'] == '惠民商城'){	$actionmapping = array (    array('actionname'=>'EditView','securitycheck' => '1','func'=>'check_add','type'=>'listview'),    array('actionname' => 'ProductProperty','securitycheck' => '1','type'=>'ajax','location'=>'base','sequence'=>'2'),	array('actionname' => 'ProductLogo','securitycheck' => '1','type'=>'ajax','location'=>'panel'),     array('actionname' => 'OnShelf','securitycheck' => '1','func'=>'isCanOnShelf','type'=>'listview'),    array('actionname' => 'OffShelf','securitycheck'=>'1','func'=>'isCanOffShelf','type'=>'listview'),	array('actionname' => 'ModifySequence','securitycheck' => '1','func'=>'ModifySequence','type'=>'listview'),	array('actionname' => 'ModifyMemberRate','securitycheck' => '1','func'=>'ModifyMemberRate','type'=>'listview'), 	array('actionname' => 'ModifyCategorys','securitycheck' => '1','func'=>'ModifyCategorys','type'=>'listview'),	array('actionname' => 'ModifyPostage','securitycheck' => '1','func'=>'ModifyPostage','type'=>'listview'),     array('actionname' => 'SimulateApply','securitycheck' => '1','type'=>'button','func'=>'check_SimulateApply'),	array('actionname' => 'ClearAllPropertys','securitycheck' => '1','func'=>'ClearAllPropertys','type'=>'listview'),	array('actionname' => 'ModifyPrice','securitycheck' => '1','func'=>'check_ModifyPrice','type'=>'listview'),  	array('actionname' => 'ModifyBand','securitycheck' => '1','func'=>'ModifyBand','type'=>'listview'),  	);}else{	$actionmapping = array (	    array('actionname'=>'EditView','securitycheck' => '1','func'=>'check_add','type'=>'listview'),	    array('actionname' => 'ProductProperty','securitycheck' => '1','type'=>'ajax','location'=>'base','sequence'=>'2'),		array('actionname' => 'ProductLogo','securitycheck' => '1','type'=>'ajax','location'=>'panel'), 	    array('actionname' => 'OnShelf','securitycheck' => '1','func'=>'isCanOnShelf','type'=>'listview'),	    array('actionname' => 'OffShelf','securitycheck'=>'1','func'=>'isCanOffShelf','type'=>'listview'),		array('actionname' => 'ModifySequence','securitycheck' => '1','func'=>'ModifySequence','type'=>'listview'),		array('actionname' => 'ModifyMemberRate','securitycheck' => '1','func'=>'ModifyMemberRate','type'=>'listview'), 		array('actionname' => 'ModifyCategorys','securitycheck' => '1','func'=>'ModifyCategorys','type'=>'listview'),		array('actionname' => 'ModifyPostage','securitycheck' => '1','func'=>'ModifyPostage','type'=>'listview'),		//array('actionname' => 'ExportExcel','securitycheck' => '1','type'=>'listview','func'=>'ExpiredList_check',),   	    //array('actionname' => 'ParameterConfig','securitycheck' => '1','type'=>'ajax','location'=>'bottom'),	    array('actionname' => 'SimulateApply','securitycheck' => '1','type'=>'button','func'=>'check_SimulateApply'),		array('actionname' => 'ClearAllPropertys','securitycheck' => '1','func'=>'ClearAllPropertys','type'=>'listview'),		array('actionname'=>'QuickModifyPriceInventory','securitycheck' => '1','func'=>'check_QuickModifyPriceInventory','type'=>'listview'),		array('actionname' => 'ModifyVendor','securitycheck' => '1','func'=>'ModifyVendor','type'=>'listview'),		array('actionname' => 'ModifyBand','securitycheck' => '1','func'=>'ModifyBand','type'=>'listview'),		array('actionname' => 'WebLink','securitycheck'=>'1','func'=>'WebLink','type'=>'listview'),		array('actionname' => 'NeedDistribution','securitycheck' => '1','func'=>'NeedDistribution','type'=>'listview'),		array('actionname' => 'CopyFromLibs','securitycheck' => '1','type'=>'button','func'=>'check_CopyFromLibs'),		);}if (!function_exists('check_QuickModifyPriceInventory')) {    function check_QuickModifyPriceInventory(){         global $current_user,$supplierid,$supplierusertype;        if (isset($supplierid) && $supplierid != '')	        return '<a href="index.php?module=Mall_Products&action=QuickModifyPriceInventory" data-title="修改库存与价格" data-height="400" data-width="660" data-id="edit" class="btn btn-default" data-group="ids" data-icon="edit" data-toggle="doajaxchecked" data-dialog=true><span>修改库存与价格</span></a>';         else            return "";     }}if (!function_exists('check_ModifyPrice')) {    function check_ModifyPrice(){         global $current_user,$supplierid,$supplierusertype;        if (isset($supplierid) && $supplierid != '')	        return '<a href="index.php?module=Mall_Products&action=ModifyPrice" data-title="修改价格" data-height="400" data-width="660" data-id="edit" class="btn btn-default" data-group="ids" data-icon="edit" data-toggle="doajaxchecked" data-dialog=true><span>修改价格</span></a>';         else            return "";     }}if (!function_exists('ModifyVendor')) {    function ModifyVendor(){        global $current_user,$supplierid,$supplierusertype;        if (isset($supplierid) && $supplierid != '' && $supplierusertype=='boss')		{		    $mall_vendors = XN_Query::create ( 'Content' ) ->tag('mall_vendors_'.$supplierid)		        ->filter ( 'type', 'eic', 'mall_vendors')		        ->filter ( 'my.deleted', '=', '0' )				->filter ( 'my.supplierid', '=' ,$supplierid) 		        ->execute();			if (count($mall_vendors) > 0)			{	            return '<a href="index.php?module=Mall_Products&action=ModifyVendor" data-title="修改供应商" data-height="400" data-width="460" data-id="edit" class="btn btn-default" data-group="ids" data-icon="edit" data-toggle="doajaxchecked" data-dialog=true><span>修改供应商</span></a>';							}	        else	            return ""; 		}        else            return "";    }}if (!function_exists('ModifyBand')) {    function ModifyBand(){        global $current_user,$supplierid,$supplierusertype;        if (isset($supplierid) && $supplierid != '' && $supplierusertype=='boss')            return '<a href="index.php?module=Mall_Products&action=ModifyBand" data-title="修改品牌" data-height="200" data-width="460" data-id="edit" class="btn btn-default" data-group="ids" data-icon="edit" data-toggle="doajaxchecked" data-dialog=true><span>修改品牌</span></a>';        else            return "";    }} if(!function_exists('ModifyCategorys')){	function ModifyCategorys(){        global $current_user,$supplierid,$supplierusertype;         if (isset($supplierid) && $supplierid != "" && $supplierusertype=='boss') 		{             return '<a href="index.php?module=Mall_Products&action=ModifyCategorys&opr=checkstutas" data-title="修改分类" data-height="200" data-width="460" data-id="edit" class="btn btn-default" data-group="ids" data-icon="edit" data-toggle="doajaxchecked" data-dialog=true><span>修改分类</span></a>';		}        else            return "";			}}if(!function_exists('ModifyPostage')){	function ModifyPostage(){        global $current_user,$supplierid,$supplierusertype;        if (isset($supplierid) && $supplierid != "" )			return '<a href="index.php?module=Mall_Products&action=ModifyPostage&opr=checkstutas" data-title="修改商品邮费" data-height="250" data-width="560" data-id="edit" class="btn btn-default" data-group="ids" data-icon="edit" data-toggle="doajaxchecked" data-dialog=true><span>修改邮费</span></a>';		else			return "";	}}  if (!function_exists('check_SimulateApply')) {    function check_SimulateApply($module,$focus)    {        global $current_user,$supplierid,$supplierusertype;        if (isset($supplierid) && $supplierid != ""  && $focus->column_fields['mall_productsstatus'] == "Saved")        {            if($focus->mode=='edit'){                if ($focus->column_fields['approvalstatus'] != '2')                {                    return '<a class="btn btn-default" data-toggle="dialog" data-icon="lock" data-mask="true" data-maxable="false" data-resizable="false" href="index.php?module='.$module.'&amp;action=SimulateApply&amp;record='.$focus->id.'" > 提交上线</a>';                }                else                {                    return '<a disabled class="btn btn-default" data-icon="lock" href="javascript:;" > 提交上线</a>';                }            }else{                return '';            }        }    }}if (!function_exists('check_CopyFromLibs')) {    function check_CopyFromLibs($module,$focus)    {        global $current_user,$supplierid,$supplierusertype;        if (isset($supplierid) && $supplierid != "")        {            				$mall_productlibs = XN_Query::create ( 'Content' ) ->tag('mall_productlibs')				    ->filter ( 'type', 'eic', 'mall_productlibs') 					->filter ( 'my.supplierid', '=',$supplierid)					->filter ( 'my.approvalstatus', '=','2')				    ->filter ( 'my.deleted', '=', '0' )					->end(1)				    ->execute ();				if ( count($mall_productlibs) > 0)				{	                if($focus->column_fields['approvalstatus'] != '2' )	                {											return '<a data-width="900" data-icon="database" lookupgroup="mall_products" data-toggle="lookupbtn" data-callback="mall_productlibs_callback" data-url="index.php?module=Mall_Products&amp;action=CopyFromLibs&amp;Popuptype=Mall_Products&amp;filter=&productid='.$focus->id.'" data-newurl="" data-oldurl="" class="btn btn-default"><span>样品库</span></a>';	                }	                else	                {	                    return '<a disabled class="btn btn-default" data-icon="database" href="javascript:;" >样品库</a>';	                }				}				else				{                	return '';            	}          }    }}?>