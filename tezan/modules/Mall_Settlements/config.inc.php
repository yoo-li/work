<?php/** * securitycheck:1表示不进行权限校验 */$Create = false;$Delete = false;$ExportExcel = true;$actionmapping = array(    array('actionname' => 'Settlements_Details', 'securitycheck' => '1', 'type' => 'ajax', 'location' => 'bottom'),    array('actionname' => 'SimulateApply', 'securitycheck' => '1', 'type' => 'button', 'func' => 'check_SimulateApply'),    array('actionname' => 'FinancialSettlement', 'securitycheck' => '1', 'type' => 'button', 'func' => 'check_FinancialSettlement'),);if (!function_exists('check_FinancialSettlement')){     function check_FinancialSettlement($module, $focus)    {        global $current_user, $supplierid, $supplierusertype;        if (isset($supplierid) && $supplierid != "" && $supplierusertype == "finance" && $focus->column_fields['mall_settlementsstatus'] == "Submit")        {                 if ($focus->mode == 'edit')                {                    if ($focus->column_fields['approvalstatus'] == '2')                    {                        return '<a data-id="simulateapply" data-icon="money" data-fresh="false" data-height="260" data-width="600"  data-mask="true" data-toggle="dialog" href="index.php?module=' . $module . '&amp;action=FinancialSettlement&amp;record=' . $focus->id . '" class="btn btn-default" ><span>财务结算</span></a>';                    }                    else                    {                        return '<a disabled class="btn btn-default" data-icon="lock" href="javascript:;" > 财务结算</a>';                    }                }                else                {                    return '<a disabled class="btn btn-default" data-icon="lock" href="javascript:;" > 财务结算</a>';                }         }    }}if (!function_exists('check_SimulateApply')){    function check_SimulateApply($module, $focus)    {        global $current_user, $supplierid, $supplierusertype;        if (isset($supplierid) && $supplierid != "" && $focus->column_fields['mall_settlementsstatus'] == "JustCreated")        {            $mall_vendors = XN_Query::create('Content')->tag('mall_vendors')                ->filter('type', 'eic', 'mall_vendors')                ->filter('my.deleted', '=', '0')                ->filter('my.supplierid', '=', $supplierid)                ->filter('my.profileid', '=', XN_Profile::$VIEWER)                ->execute();            if (count($mall_vendors) > 0)            {                if ($focus->mode == 'edit')                {                    if ($focus->column_fields['approvalstatus'] != '2')                    {                        return '<a data-id="simulateapply" data-icon="money" data-fresh="false" data-height="260" data-width="600"  data-mask="true" data-toggle="dialog" href="index.php?module=' . $module . '&amp;action=SimulateApply&amp;record=' . $focus->id . '" class="btn btn-default" ><span>提交结算</span></a>';                    }                    else                    {                        return '<a disabled class="btn btn-default" data-icon="lock" href="javascript:;" > 提交结算</a>';                    }                }                else                {                    return '<a disabled class="btn btn-default" data-icon="lock" href="javascript:;" > 提交结算</a>';                }            }        }    }}?>